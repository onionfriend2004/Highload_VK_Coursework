# Highload VK Education

[Задание](https://github.com/init/highload/blob/main/homework_architecture.md)

Курсовая работа по дисциплине "Проектирование высоконагруженных систем"

*Лупенков Алексей, осень 2025*


## Содержание
* [**1. Тема, аудитория, функционал**](#1-тема-аудитория-функционал)

* [**2. Расчёт нагрузки**](#2-расчёт-нагрузки)

## 1. Тема, аудитория, функционал

### Тема

Zoom - сервис для видеоконференций

### Аудитория

#### Мировой рынок [[1](https://www.demandsage.com/zoom-statistics/)]
* Пользователи:
  * ```700 млн. MAU```[[2](https://www.marketingscoop.com/blog/zoom-monthly-active-users-the-ultimate-guide-2024/)]
  * ```300 млн. DAU```
  * ```3.3 трлн. минут встреч в год```
  * ```45 млрд. записанных минут встреч в год```

#### Распределение по странам [[3](https://www.statista.com/statistics/1259936/distribution-of-zoomus-traffic-by-country/)]
* *США - ```42.06%``` пользователей*:
  * ```700 × 0.4206 = 294,42 млн. MAU```
  * ```300 × 0.4206 = 126.18 млн. DAU```
  * ```3.3 × 0.4206 = 1.39 трлн. минут встреч в год```
  * ```45 × 0.4206 = 18.9 млрд. записанных минут встреч в год```
* *Япония - ```4.26%``` пользователей*:
  * ```700 × 0.0426 = 29.82 млн. MAU```
  * ```300 × 0.0426 = 12.78 млн. DAU```
  * ```3.3 × 0.0426 = 0.14 трлн. минут встреч в год```
  * ```45 × 0.0426 = 1.9 млрд. записанных минут встреч в год```
* *Канада - ```4.14%``` пользователей*:
  * ```700 × 0.0414 = 28.98 млн. MAU```
  * ```300 × 0.0414 = 12.42 млн. DAU```
  * ```3.3 × 0.0414 = 0.14 трлн. минут встреч в год```
  * ```45 × 0.0414 = 1.9 млрд. записанных минут встреч в год```
* *Индия - ```3.86%``` пользователей*:
  * ```700 × 0.0386 = 27.02 млн. MAU```
  * ```300 × 0.0386 = 11.58 млн. DAU```
  * ```3.3 × 0.0386 = 0.13 трлн. минут встреч в год```
  * ```45 × 0.0386 = 1.7 млрд. записанных минут встреч в год```
* *Великобритания - ```3.86%``` пользователей*:
  * ```700 × 0.0386 = 27.02 млн. MAU```
  * ```300 × 0.0386 = 11.58 млн. DAU```
  * ```3.3 × 0.0386 = 0.13 трлн. минут встреч в год```
  * ```45 × 0.0386 = 1.7 млрд. записанных минут встреч в год```
* *Остальные страны - ```41.82%``` пользователей*:
  * ```700 × 0.4182 = 292,74 млн. MAU```
  * ```300 × 0.4182 = 125.46 млн. DAU```
  * ```3.3 × 0.4182 = 1.38 трлн. минут встреч в год```
  * ```45 × 0.4182 = 18.8 млрд. записанных минут встреч в год```

### Функционал

Ключевое продуктовое решение - запись звонка на стороне сервера

* Регистрация и авторизация
* Создание конференции
    * Аудио/видео связь
    * Запись звонка
    * Удаление/добавление участников
* Вход в конференцию по ссылке
* Текстовый чат

## 2. Расчёт нагрузки

### Расчет среднего размера хранилища на одного пользователя
* Фото польователя и персональная информация

Возьмем размер аватарки за 400×400 пикселей в формате jpeg. Такое изображение в среднем весит 100 кб. Допустим, что имя пользователя максимум может содержать 20 символов UTF-8, информация о пользователе может содержать максимум 500 символов UTF-8. Тогда:


$$100 + \frac{520}{1024} \approx 101 \space Кб$$

* Записи конференций

Средняя продолжительность конференции 54 минуты, среднее количество участников 10 человек [[4](https://www.zoom.com/en/blog/how-you-zoomed-over-the-past-year-2021/?lang=en-US)]. Количество конференций в день:

$$\frac{3.3 \cdot 10^{12}}{54 \cdot 10 \cdot 365} \approx 16742770 \space встреч \space в  \space день$$

Соотношение записанных минут встреч к незаписанным:

$$\frac{45 \cdot 10^{9}}{3.3 \cdot 10^{12}} \approx 0.0136$$

Количество записанных встреч в день:

$$16742770 \cdot 0.0136 \approx 227701 \space записанных \space встреч \space в  \space день$$

Количество записей в месяц на 1 пользователя:

$$\frac{227701}{7 \cdot 10^8} \cdot 30 \approx 0.0098$$

1 запись приблизительно равна 1 часу видео в месяц. 1 час видео в формате HD занимает примерно 1 Гб.

* Планирование конференций, информация о ссылках и т.п.

Содержит 500 символов UTF-8:

$$\frac{500}{1024} \approx 0.5 \space Кб$$

### Расчет среднего количества действий пользователя по типам в день
* Авторизация

Пусть пользователь входит 10 раз в месяц

* Создание конференции

$$\frac{16742770}{7 \cdot 10^{8}} \cdot 30 \approx 0.7 \space конференций \space в \space месяц$$

* Отправка сообщений в чат

Пусть 1 пользователь отправляет 10 сообщений за конференцию, тогда:

$$10 \cdot 7 \approx 70 \space сообщений \space в \space месяц$$

* Присоединение к конференции

$$0.7 \cdot 10 \approx 7 \space присоединений \space в \space месяц$$

* Сохранение записей

Пользователь сохраняет 0.01 встречу в месяц

### Расчет размера хранилища данных

* Фото и персональная информация

$$\frac{101 \cdot 7 \cdot 10^8}{1024 \cdot 1024 \cdot 1024} = 67,43  \space Тб/мес$$

* Записи конференций

$$\frac{0.01 \cdot 7 \cdot 10^8}{1024\cdot 1024} = 6,68 \space Пб/мес$$

* Планирование конференций, информация о ссылках и т.п.

$$\frac{0.5 \cdot 7 \cdot 10^8}{1024 \cdot 1024} = 333 \space Мб/мес$$

* Записи чатов

Пусть в 1 конференции чат содержит в среднем 10000 символов, тогда:

$$\frac{10000 \cdot 4 \cdot 7 \cdot 10^8}{1024^4} = 25.47 \space Тб/мес$$

* Хранилище сессий

Одна сессия (sessionID, userID):
$$16 + 8 \space Б = 24 \space Б$$

$$\frac{24 \cdot 7 \cdot 10^8}{1024 \cdot 1024 \cdot 1024} = 15.65 \space Гб/мес$$

* Хранилище звонков

Один звонок (id, таймстемпы начала и конца, userIDs) байта:

$$16 + 16 + 16 + 8 \cdot 10 = 128 \space Б$$ 

$$\frac{128 \cdot 7 \cdot 10^8}{1024 \cdot 1024 \cdot 1024} = 83.45 \space Гб/мес$$ 

### Расчет сетевого трафика

TODO

### Расчет RPS 

TODO

### Продуктовые метрики

| Метрика                                | Значение                  |
|----------------------------------------|---------------------------|
| Месячная аудитория (MAU)               | 700 млн пользователей     |
| Дневная аудитория (DAU)                | 300 млн пользователей     |
| Профиль (аватар + данные)              | ~101 КБ/мес               |
| Планирование конференций               | ~0.5 КБ/мес               |
| Записи конференций                     | ~0.01 ГБ/мес              |
| Авторизация                            | 10/мес                    |
| Создание конференций                   | 0.7/мес                   |
| Присоединение к конференциям           | 7/мес                     |
| Отправка сообщений в чат               | 70/мес                    |
| Сохранение записей                     | 0.01/мес                  |

### Технические метрики

TODO

## Источники
1. https://www.demandsage.com/zoom-statistics/
2. https://www.marketingscoop.com/blog/zoom-monthly-active-users-the-ultimate-guide-2024/
3. https://www.statista.com/statistics/1259936/distribution-of-zoomus-traffic-by-country/
4. https://www.zoom.com/en/blog/how-you-zoomed-over-the-past-year-2021/?lang=en-US